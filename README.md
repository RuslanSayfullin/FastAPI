##### _—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Sayfullin R.R.

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –¥–ª—è Linux-—Å–∏—Å—Ç–µ–º.
========================================================================================================================
–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
    python = "^3.11.11"
    fastapi = "^0.115.12"
    PostgreSQL

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:
$ git clone https://github.com/RuslanSayfullin/FastAPI.git
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –æ—Å–Ω–æ–≤–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã: 
$ cd FastAPI

========================================================================================================================
–°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: 
    $ python3 -m venv venv 
    $ source venv/bin/activate 
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ —Ñ–∞–π–ª–∞ requirements.txt:
    (venv) $ pip install -r requirements.txt

C–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π—Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:
    $ pip freeze > requirements.txt

Open the inreactive documentation: http://localhost:8000/docs

# –ò—Å—Ç–æ—á–Ω–∏–∫
========================================================================================================================
https://github.com/PacktPublishing/Building-Data-Science-Applications-with-FastAPI-Second-Edition

Building Data Science Applications with FastAPI.
================================================
Part 1: Introduction to Python and FastAPI
    1. Python Development Environment Setup
    2. Python Programming Specificities
    3. Developing a RESTful API with FastAPI
    4. Managing Pydantic Data Models in FastAPI
    5. Dependency Injection in FastAPI
Part 2: Building and Deploying a Complete Web Backend with FastAPI
    6. Databases and Asynchronous ORMs
    7. Managing Authentication and Security in FastAPI
    8. Defining WebSockets for Two-Way Interactive Communication in FastAPI
    9. Testing an API Asynchronously with pytest and HTTPX
    10. Deploying a FastAPI Project
Part 3: Building Resilient and Distributed Data Science Systems with FastAPI
    11. Introduction to Data Science in Python
    12. Creating an Efficient Prediction API Endpoint with FastAPI
    13. Implementing a Real-Time Object Detection System Using WebSockets with FastAPI
    14. Creating a Distributed Text-to-Image AI System Using the Stable Diffusion Model
    15. Monitoring the Health and Performance of a Data Science System



#####
–ö–ª–∞—Å—Å Header –≤ FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –∏—Ö –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞.

–û—Å–Ω–æ–≤–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ Header:
    1. –î–æ—Å—Ç—É–ø –∫ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º –∑–∞–ø—Ä–æ—Å–∞
    - –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫:
        * User-Agent
        * Authorization (—Ç–æ–∫–µ–Ω—ã, API-–∫–ª—é—á–∏)
        * Content-Type
        * –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, X-Request-ID)
    2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
    - FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–∏–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä, str, int, bool).
    3. –£–∫–∞–∑–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –∏–º–µ–Ω –∏ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    - –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å:
        * alias (–µ—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ —Ç–∞–∫, –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏),
        * default (–∑–Ω–∞—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç).

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ User-Agent:

    from fastapi import FastAPI, Header
    app = FastAPI()

    @app.get("/user-agent/")
    async def get_user_agent(user_agent: str = Header(...)):
        return {"User-Agent": user_agent}

    –ó–¥–µ—Å—å Header(...) –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω. –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç ‚Äî FastAPI –≤–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É 422.

2. –ö–∞—Å—Ç–æ–º–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º:
    
    from fastapi import FastAPI, Header
    app = FastAPI()

    @app.get("/items/")
    async def read_items(x_token: str = Header(default="secret-token")):
        return {"X-Token": x_token}
    
    –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞—Å—Ç X-Token, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ "secret-token".

3. –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –¥—Ä—É–≥–∏–º –∏–º–µ–Ω–µ–º (–∞–ª–∏–∞—Å):

    from fastapi import FastAPI, Header
    app = FastAPI()

    @app.get("/secure/")
    async def secure_endpoint(api_key: str = Header(..., alias="X-API-Key")):
        return {"API-Key": api_key}

    FastAPI –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-API-Key, –Ω–æ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–Ω –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ api_key.

–í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã:
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤:
    FastAPI –ø—ã—Ç–∞–µ—Ç—Å—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–∏–ø. 
    –ù–∞–ø—Ä–∏–º–µ—Ä: 
        is_admin: bool = Header(False)  # "true" ‚Üí True, "1" ‚Üí True, etc.
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:
    –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Accept-Encoding) –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–µ—Ñ–∏—Å—ã (-), –ø–æ—ç—Ç–æ–º—É –≤ Python –∏—Ö –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å —Å –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ–º (_), –∞ FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ–¥–µ—Ç –º–∞–ø–ø–∏–Ω–≥:
        accept_encoding: str = Header(...)  # –°—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è "Accept-Encoding"
–ù–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:
    –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Set-Cookie), —É–∫–∞–∂–∏—Ç–µ list:
        cookies: list[str] = Header([])

Header ‚Äî —ç—Ç–æ —É–¥–æ–±–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç FastAPI –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –≤–∞–ª–∏–¥–∞—Ü–∏—é, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é —Ç–∏–ø–æ–≤ –∏ –≥–∏–±–∫–æ—Å—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ.
#####


–ö–ª–∞—Å—Å Depends –≤ FastAPI ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Injection). 
–û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç:
    - –í—ã–Ω–æ—Å–∏—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â—É—é—Å—è –ª–æ–≥–∏–∫—É (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –ø—Ä–æ–≤–µ—Ä–∫–∏, –¥–æ—Å—Ç—É–ø –∫ –ë–î) –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏/–∫–ª–∞—Å—Å—ã.
    - –£–ø—Ä–æ—â–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ª–µ–≥–∫–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å –Ω–∞ –º–æ–∫–∏).
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞—Ç—å –∫–æ–¥ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–∫–µ–Ω –∏–ª–∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞).

–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Depends:
1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤ –∫–∞–∂–¥–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ, –≤—ã–Ω–æ—Å–∏–º –µ–≥–æ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏ –≤–Ω–µ–¥—Ä—è–µ–º —á–µ—Ä–µ–∑ Depends.
    –ü—Ä–∏–º–µ—Ä: 
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ API-–∫–ª—é—á–∞. –ó–¥–µ—Å—å verify_api_key –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º protected_route. –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ–≤–µ—Ä–Ω—ã–π ‚Äî –∑–∞–ø—Ä–æ—Å –ø—Ä–µ—Ä–≤–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π 403.
    from fastapi import FastAPI, Depends, HTTPException, Header

    app = FastAPI()

    def verify_api_key(api_key: str = Header(...)):
        if api_key != "secret-key":
            raise HTTPException(status_code=403, detail="Invalid API Key")
        return api_key

    @app.get("/protected/")
    async def protected_route(api_key: str = Depends(verify_api_key)):
        return {"message": "Access granted"}
    
2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–≥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏–∑ –ø—É—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞, query-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Ç.–¥.
    –ü—Ä–∏–º–µ—Ä: 
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∏–∑ –ë–î –ø–æ ID. FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞—Å—Ç item_id –∏–∑ –ø—É—Ç–∏ –≤ get_item.
    from fastapi import FastAPI, Depends

    app = FastAPI()

    async def get_item(item_id: int):
        #–∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        return {"id": item_id, "name": "Sample Item"}

    @app.get("/items/{item_id}")
    async def read_item(item: dict = Depends(get_item)):
        return item

3. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–≥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –¥—Ä—É–≥–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–∫–∞–∫ –º–∞—Ç—Ä–µ—à–∫–∞).
    –ü—Ä–∏–º–µ—Ä: 
    
    # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è + –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
    from fastapi import FastAPI, Depends, Header, HTTPException

    app = FastAPI()

    def get_current_user(token: str = Header(...)):
    return {"user": "admin", "token": token}  # –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç—É—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ JWT

    def check_admin(user: dict = Depends(get_current_user)):
        if user["user"] != "admin":
            raise HTTPException(status_code=403, detail="Admins only")
        return user

    @app.get("/admin/")
    async def admin_panel(user: dict = Depends(check_admin)):
        return {"message": "Welcome, admin!"}

    # –°–Ω–∞—á–∞–ª–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è get_current_user (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω).
    # –ó–∞—Ç–µ–º check_admin (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).
    # –ò —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç admin_panel.

4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. Depends —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –Ω–æ –∏ —Å –∫–ª–∞—Å—Å–∞–º–∏ (—É–¥–æ–±–Ω–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π).
    –ü—Ä–∏–º–µ—Ä: 
    
    # –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
    from fastapi import FastAPI, Depends, Header, HTTPException

    app = FastAPI()

    class Database:
        def __init__(self, url: str = "sqlite:///db.sqlite"):
            self.url = url

        def get_data(self):
            return {"data": "from database"}

    def get_db():
        return Database()  # –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

    @app.get("/data/")
    async def fetch_data(db: Database = Depends(get_db)):
        return db.get_data()

5. –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–æ—É—Ç–µ—Ä–∞ –∏–ª–∏ –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –∏–ª–∏ –≤—Å–µ–≥–æ FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    –ü—Ä–∏–º–µ—Ä: 
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ API-–∫–ª—é—á–∞ –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
    from fastapi import FastAPI, Depends

    app = FastAPI(dependencies=[Depends(verify_api_key)])

    @app.get("/hello/")
    async def hello():
        return {"message": "Hello"}  # –ë—É–¥–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å API-–∫–ª—é—á

–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Depends
‚úÖ –ß–∏—Å—Ç—ã–π –∫–æ–¥ ‚Äî –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥—É–ª–∏.
‚úÖ –ì–∏–±–∫–æ—Å—Ç—å ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å.
‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å ‚Äî –≤ —Ç–µ—Å—Ç–∞—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ª–µ–≥–∫–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å.
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è ‚Äî FastAPI —Å–∞–º –≤—ã–∑—ã–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –Ω—É–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç.

–í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã
–ü–æ—Ä—è–¥–æ–∫ –≤—ã–∑–æ–≤–∞: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è.
–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–µ—à–∏—Ä—É–µ—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (–µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω –∫–µ—à, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ use_cache=False –≤ Depends).
–û—à–∏–±–∫–∏: –ï—Å–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤—ã–∑—ã–≤–∞–µ—Ç HTTPException, –∑–∞–ø—Ä–æ—Å –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è.

–ò—Ç–æ–≥
Depends ‚Äî —ç—Ç–æ "–º–∞–≥–∏—á–µ—Å–∫–∏–π" –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç FastAPI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–∏—Å—Ç–æ–π, –º–æ–¥—É–ª—å–Ω–æ–π –∏ –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π –ª–æ–≥–∏–∫–∏. –û–Ω –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è:
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (JWT, OAuth2).
- –î–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö.
-  –í–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ç—Ä–µ–π—Å–∏–Ω–≥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.
#####


–ö–ª–∞—Å—Å Query –≤ FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å query-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ URL, –∫–æ—Ç–æ—Ä—ã–µ –∏–¥—É—Ç –ø–æ—Å–ª–µ ?). 
–û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç:
    - –ò–∑–≤–ª–µ–∫–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è query-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞.

    - –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∏—Ö (–ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–∏–ø, –¥–ª–∏–Ω—É, –¥–∏–∞–ø–∞–∑–æ–Ω –∏ —Ç.–¥.).

    - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –æ–ø–∏—Å–∞–Ω–∏—è –∏ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API.

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Query:


1. –ü—Ä–æ—Å—Ç–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ query-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞.
    # –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
    from fastapi import FastAPI, Query

    app = FastAPI()

    @app.get("/items/")
    async def read_items(q: str = Query(...)):  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
        return {"q": q}

    # –ó–∞–ø—Ä–æ—Å: /items/?q=hello ‚Üí –û—Ç–≤–µ—Ç: {"q": "hello"}.
    # –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä q –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω ‚Äî FastAPI –≤–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É 422 (Unprocessable Entity).

2. –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    from fastapi import FastAPI, Query

    app = FastAPI()

    @app.get("/items/")
    async def read_items(q: str = Query(None)):  # –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
        return {"q": q}

    # –ó–∞–ø—Ä–æ—Å: /items/ ‚Üí –û—Ç–≤–µ—Ç: {"q": null}.
    # –ó–∞–ø—Ä–æ—Å: /items/?q=test ‚Üí –û—Ç–≤–µ—Ç: {"q": "test"}.
    # –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: (q: str = Query("default_value"))

3. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–∏
    from fastapi import FastAPI, Query

    app = FastAPI()

    @app.get("/items/")
    async def read_items(q: str = Query(..., min_length=3, max_length=10)):
        return {"q": q}

    #   /?q=ab ‚Üí –û—à–∏–±–∫–∞: –¥–ª–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ‚â• 3.
    #   /?q=abcdefghijk ‚Üí –û—à–∏–±–∫–∞: –¥–ª–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ‚â§ 10.
    # –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è: (q: str = Query(..., regex="^[a-z]+$"))  # –¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
    # –ß–∏—Å–ª–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (min/max): (price: float = Query(..., gt=0, lt=1000))  # –ß–∏—Å–ª–æ –æ—Ç 0 –¥–æ 1000

4. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å–ø–∏—Å–∫–∏)
    # –ü–æ–ª—É—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, /items/?q=foo&q=bar)
    from fastapi import FastAPI, Query

    app = FastAPI()

    @app.get("/items/")
    async def read_items(q: list[str] = Query(...)):
        return {"q": q}

    # –ó–∞–ø—Ä–æ—Å: /items/?q=foo&q=bar ‚Üí –û—Ç–≤–µ—Ç: {"q": ["foo", "bar"]}.

5. –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è, –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ deprecated-—Ñ–ª–∞–≥–æ–≤
    from fastapi import FastAPI, Query

    app = FastAPI()

    @app.get("/items/")
    async def read_items(
        q: str = Query(
            None,
            title="Search Query",
            description="Filter items by keyword",
            example="apple",
            deprecated=True
        )
    ):
        return {"q": q}
    

    # –≠—Ç–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –≤ Swagger –∏ Redoc:
    # –ü–æ–¥—Å–∫–∞–∑–∫–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º.
    # –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è.
    # –ü–æ–º–µ—Ç–∫–∞, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä —É—Å—Ç–∞—Ä–µ–ª.

6. –ê–ª–∏–∞—Å—ã (–¥—Ä—É–≥–æ–µ –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞)
    # –ï—Å–ª–∏ query-–ø–∞—Ä–∞–º–µ—Ç—Ä –¥–æ–ª–∂–µ–Ω –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è –Ω–µ —Ç–∞–∫, –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤ Python
    from fastapi import FastAPI, Query

    app = FastAPI()

    @app.get("/items/")
    async def read_items(search: str = Query(..., alias="q")):
        return {"search": search}
    
    # –ó–∞–ø—Ä–æ—Å: /items/?q=hello ‚Üí –í —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–ø–∞–¥–µ—Ç search="hello".

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Query?
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ/–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ URL.
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∏, —á–∏—Å–ª–∞, —Å–ø–∏—Å–∫–∏).
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API (–æ–ø–∏—Å–∞–Ω–∏—è, –ø—Ä–∏–º–µ—Ä—ã).
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–∞–ª–∏–∞—Å—ã).

–í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã
–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Path –∏ Body:
    Query —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å query-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –î–ª—è —á–∞—Å—Ç–µ–π URL –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Path, –¥–ª—è —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ ‚Äî Body.
–ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
    Query(None) ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π.
    Query(...) ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π (–∞–Ω–∞–ª–æ–≥ Required).
Deprecated-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
    –ü–æ–º–µ—Ç–∫–∞ deprecated=True –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ª–æ–≥–∏–∫—É, –Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ API –æ–± —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.

–ò—Ç–æ–≥:
Query ‚Äî —ç—Ç–æ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±:
‚úÖ –ò–∑–≤–ª–µ–∫–∞—Ç—å query-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
‚úÖ –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∏—Ö.
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å API.
‚úÖ –ì–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–∞–ª–∏–∞—Å—ã, deprecated, –ø—Ä–∏–º–µ—Ä—ã).

–ë–µ–∑ Query –ø—Ä–∏—à–ª–æ—Å—å –±—ã –≤—Ä—É—á–Ω—É—é –ø–∞—Ä—Å–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL, —á—Ç–æ —É—Å–ª–æ–∂–Ω–∏–ª–æ –±—ã –∫–æ–¥.
#####


–ö–ª–∞—Å—Å Path –≤ FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—É—Ç–∏ (path parameters) ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —á–∞—Å—Ç—è–º–∏ URL, 
–∫–æ—Ç–æ—Ä—ã–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ —Å–∞–º–æ–≥–æ –ø—É—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, items/42, –≥–¥–µ 42 ‚Äî —ç—Ç–æ ID —ç–ª–µ–º–µ–Ω—Ç–∞). 
–û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, —á—Ç–æ –∏ Query, –Ω–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∏–º–µ–Ω–Ω–æ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ Path:
1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ URL:
    # –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –ø—É—Ç–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∏—Ö –≤ –Ω—É–∂–Ω—ã–π —Ç–∏–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä, int, str, UUID).
    from fastapi import FastAPI, Path

    app = FastAPI()

    @app.get("/items/{item_id}")
    async def read_item(item_id: int = Path(...)):  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
        return {"item_id": item_id}

    # –ó–∞–ø—Ä–æ—Å GET /items/42 ‚Üí {"item_id": 42}.
    # –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–µ —á–∏—Å–ª–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, items/foo), FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω—ë—Ç –æ—à–∏–±–∫—É 422 (Unprocessable Entity).

2. –ú–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π:
    - –ß–∏—Å–ª–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: gt (–±–æ–ª—å—à–µ), ge (–±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ), lt (–º–µ–Ω—å—à–µ), le (–º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ).
    - –°—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: min_length, max_length, regex.

    # –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. 
    from fastapi import FastAPI, Path

    app = FastAPI()

    @app.get("/items/{item_id}")
    async def read_item(
        item_id: int = Path(..., gt=0, title="Item ID", description="Must be positive"),  # –¢–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
        name: str = Path(..., min_length=3, max_length=50)  # –°—Ç—Ä–æ–∫–∞ –æ—Ç 3 –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤
    ):
        return {"item_id": item_id, "name": name}
    
    # GET /items/-5 ‚Üí –û—à–∏–±–∫–∞: item_id –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å > 0.
    # GET /items/42?name=ab ‚Üí –û—à–∏–±–∫–∞: name –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–ª–∏–Ω–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤.

3. –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
    # –ö–∞–∫ –∏ –≤ Query, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ, –ø—Ä–∏–º–µ—Ä—ã –∏ –ø–æ–º–µ—Ç–∫–∏ –¥–ª—è Swagger/Redoc
    from fastapi import FastAPI, Path

    app = FastAPI()

    @app.get("/users/{user_id}")
    async def get_user(
        user_id: int = Path(
            ...,
            title="User ID",
            description="Unique identifier for the user",
            example=123,
        )
    ):
        return {"user_id": user_id}

4. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:
    # –•–æ—Ç—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏ –æ–±—ã—á–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ, –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Ä–µ–¥–∫–∏–π —Å–ª—É—á–∞–π, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ)
    from fastapi import FastAPI, Path

    app = FastAPI()

    app.get("/items/{item_id}")
    async def read_item(item_id: int = Path(default=1)):  # –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—Ç—å, –±—É–¥–µ—Ç 1
        return {"item_id": item_id}

    # –ù–æ —á–∞—â–µ Path(...) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.


–ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è Path –æ—Ç Query
Path	                                            Query
–î–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ URL-–ø—É—Ç–∏ (/items/{item_id}).	    –î–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ URL-—Å—Ç—Ä–æ–∫–µ (/items?name=foo).
–ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π.	                        –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –∏–ª–∏ –Ω–µ—Ç.
–í–∞–ª–∏–¥–∞—Ü–∏—è: gt, ge, lt, le (–¥–ª—è —á–∏—Å–µ–ª).	            –í–∞–ª–∏–¥–∞—Ü–∏—è: min_length, regex (–¥–ª—è —Å—Ç—Ä–æ–∫).
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äî —á–∞—Å—Ç—å –ø—É—Ç–∏.	        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ç.–¥.


–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
    from fastapi import FastAPI, Path

    app = FastAPI()

    # –°–ª–æ–∂–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–∏—Å–ª–∞
    @app.get("/products/{product_id}")
    async def get_product(
        product_id: int = Path(..., gt=1000, le=9999),  # –î–æ–ø—É—Å—Ç–∏–º, ID —Ç–æ–≤–∞—Ä–∞ –æ—Ç 1001 –¥–æ 9999
    ):
        return {"product_id": product_id}

        # GET /products/500 ‚Üí –û—à–∏–±–∫–∞: product_id –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å > 1000.
        # GET /products/1001 ‚Üí –£—Å–ø–µ—Ö: {"product_id": 1001}.

    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å Query –∏ Path –≤–º–µ—Å—Ç–µ
    @app.get("/users/{user_id}/orders")
    async def get_orders(
        user_id: int = Path(..., title="User ID"),
        limit: int = Query(10, gt=0),  # Query-–ø–∞—Ä–∞–º–µ—Ç—Ä
        active_only: bool = Query(True)  # –ï—â—ë –æ–¥–∏–Ω query-–ø–∞—Ä–∞–º–µ—Ç—Ä
    ):
        return {"user_id": user_id, "limit": limit, "active_only": active_only}

        # –ó–∞–ø—Ä–æ—Å: GET /users/42/orders?limit=5&active_only=false.
        # –û—Ç–≤–µ—Ç: {"user_id": 42, "limit": 5, "active_only": false}.

    # UUID –≤–º–µ—Å—Ç–æ —á–∏—Å–µ–ª
    from uuid import UUID

    @app.get("/files/{file_id}")
    async def read_file(file_id: UUID = Path(...)):  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è UUID
        return {"file_id": file_id}

    # –ó–∞–ø—Ä–æ—Å: GET /files/123e4567-e89b-12d3-a456-426614174000 ‚Üí –£—Å–ø–µ—Ö.
    # –ó–∞–ø—Ä–æ—Å: GET /files/123 ‚Üí –û—à–∏–±–∫–∞: –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π UUID.

–ö–ª–∞—Å—Å Path –≤ FastAPI –Ω—É–∂–µ–Ω –¥–ª—è:
- –ò–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –ø—É—Ç–∏ URL.
- –í–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π (—á–∏—Å–ª–∞, —Å—Ç—Ä–æ–∫–∏, UUID).
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API (–æ–ø–∏—Å–∞–Ω–∏—è, –ø—Ä–∏–º–µ—Ä—ã).
- –ì–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∞–ª–∏–∞—Å—ã, deprecated-—Ñ–ª–∞–≥–∏).

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –≤—Å–µ—Ö –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –ø—É—Ç–∏, —á—Ç–æ–±—ã –∫–æ–¥ –±—ã–ª –Ω–∞–¥—ë–∂–Ω—ã–º –∏ —Å–∞–º–æ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º—ã–º! 
#####


–ö–ª–∞—Å—Å status –≤ FastAPI (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ fastapi.status) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç HTTP-–∫–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –≤–∏–¥–µ —É–¥–æ–±–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç. 
–≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ —á–∏—â–µ, –∏–∑–±–µ–≥–∞—è "–º–∞–≥–∏—á–µ—Å–∫–∏—Ö —á–∏—Å–µ–ª" –∏ —Å–Ω–∏–∂–∞—è —Ä–∏—Å–∫ –æ—à–∏–±–æ–∫.
–ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å status –≤–º–µ—Å—Ç–æ "—Å—ã—Ä—ã—Ö" —á–∏—Å–µ–ª?
    - –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å ‚Äì status.HTTP_200_OK –ø–æ–Ω—è—Ç–Ω–µ–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ 200.
    - –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ ‚Äì IDE –ø–æ–¥—Å–∫–∞–∂–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–¥—ã (–º–µ–Ω—å—à–µ —à–∞–Ω—Å–æ–≤ –æ—à–∏–±–∏—Ç—å—Å—è).
    - –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å ‚Äì –≥–∞—Ä–∞–Ω—Ç–∏—è, —á—Ç–æ –∫–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ—Ç 999).

–û—Å–Ω–æ–≤–Ω—ã–µ HTTP-–∫–æ–¥—ã –∏–∑ status:
# –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
status.HTTP_200_OK  # 200 (OK)
status.HTTP_201_CREATED  # 201 (–°–æ–∑–¥–∞–Ω–æ)
status.HTTP_204_NO_CONTENT  # 204 (–ù–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ)

# –û—à–∏–±–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞
status.HTTP_400_BAD_REQUEST  # 400 (–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å)
status.HTTP_401_UNAUTHORIZED  # 401 (–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
status.HTTP_403_FORBIDDEN  # 403 (–ó–∞–ø—Ä–µ—â–µ–Ω–æ)
status.HTTP_404_NOT_FOUND  # 404 (–ù–µ –Ω–∞–π–¥–µ–Ω–æ)

# –û—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
status.HTTP_500_INTERNAL_SERVER_ERROR  # 500 (–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞)

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
1. –£–∫–∞–∑–∞–Ω–∏–µ –∫–æ–¥–∞ –æ—Ç–≤–µ—Ç–∞ –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ:
    from fastapi import FastAPI, status

    app = FastAPI()

    @app.post("/items/", status_code=status.HTTP_201_CREATED)
    async def create_item():
        return {"message": "Item created"}
    
    # –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤–µ—Ä–Ω—ë—Ç—Å—è –∫–æ–¥ 201.

2. –í–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–∫–∏ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º:
    from fastapi import FastAPI, status, HTTPException

    app = FastAPI()

    @app.get("/items/{id}")
    async def read_item(id: int):
        if id == 0:
            raise HTTPException(
                status_code=status.HTTP_404_NOT_FOUND,
                detail="Item not found"
            )
        return {"id": id}

    # –ï—Å–ª–∏ id=0, –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∏—Ç 404.

3. –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è —Ä–µ–¥–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:
    from fastapi import FastAPI, status, HTTPException

    app = FastAPI()

    @app.post("/payment/")
    async def process_payment():
        # –ù–∞–ø—Ä–∏–º–µ—Ä, 402 (–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞) –¥–ª—è –ø–ª–∞—Ç–Ω–æ–≥–æ API
        return {"detail": "Payment required"}, status.HTTP_402_PAYMENT_REQUIRED

–ö–ª–∞—Å—Å —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP-—Å—Ç–∞—Ç—É—Å—ã –∏–∑ RFC (–≤–∫–ª—é—á–∞—è —Ä–µ–¥–∫–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä):
    HTTP_418_IM_A_TEAPOT (418 –Ø ‚Äî —á–∞–π–Ω–∏–∫)
    HTTP_451_UNAVAILABLE_FOR_LEGAL_REASONS (451 –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º –ø—Ä–∏—á–∏–Ω–∞–º)


fastapi.status ‚Äì —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö HTTP-–∫–æ–¥–æ–≤ –≤ –≤–∏–¥–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- status_code –≤ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞—Ö (@app.get).
- HTTPException(status_code=...).
- –†—É—á–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ (return Response(status_code=...)).
–ü–ª—é—Å—ã: —á–∏—Ç–∞–µ–º–æ—Å—Ç—å, –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä—è–º–æ –≤ –∫–æ–¥–µ.

–ü—Ä–∏–º–µ—Ä:
    from fastapi import FastAPI, status, HTTPException

    app = FastAPI()

    @app.get("/admin/", status_code=status.HTTP_200_OK)
    async def admin_panel():
        if not is_admin:
            raise HTTPException(
                status_code=status.HTTP_403_FORBIDDEN,
                detail="Admins only!"
            )
        return {"message": "Welcome, admin!"}

#####


–ö–ª–∞—Å—Å Body –≤ FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º–∏ –≤ —Ç–µ–ª–µ HTTP-–∑–∞–ø—Ä–æ—Å–∞ (–æ–±—ã—á–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON). 
–û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç:
    - –ò–∑–≤–ª–µ–∫–∞—Ç—å –∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞.
    - –£–∫–∞–∑—ã–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ/–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.
    - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å API (–¥–æ–±–∞–≤–ª—è—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è, –ø—Ä–∏–º–µ—Ä—ã).
    - –ì–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –ø–æ–ª—è —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏).

–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ Body:
1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
    # –ø–æ–ª—É—á–µ–Ω–∏–µ JSON-–æ–±—ä–µ–∫—Ç–∞ –≤ POST-–∑–∞–ø—Ä–æ—Å–µ.
    from fastapi import FastAPI, Body

    app = FastAPI()

    @app.post("/items/")
    async def create_item(item: dict = Body(...)):  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
        return {"item": item}

    # –ó–∞–ø—Ä–æ—Å: curl -X POST http://localhost:8000/items/ -H "Content-Type: application/json" -d '{"name": "Book", "price": 100}'
    # –û—Ç–≤–µ—Ç: {"item": {"name": "Book", "price": 100}}

2. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö. Body –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–µ –∂–µ –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, —á—Ç–æ –∏ Pydantic:
    - min_length, max_length (–¥–ª—è —Å—Ç—Ä–æ–∫).
    - gt, lt (–¥–ª—è —á–∏—Å–µ–ª).
    - –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (regex).

    # –ü—Ä–∏–º–µ—Ä —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π:
    from fastapi import FastAPI, Body
    from pydantic import BaseModel

    app = FastAPI()

    class Item(BaseModel):
        name: str
        price: float = Body(..., gt=0)  # –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å > 0

    @app.post("/items/")
    async def create_item(item: Item):
        return item

    # –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å {"name": "Book", "price": -10}, FastAPI –≤–µ—Ä–Ω—ë—Ç –æ—à–∏–±–∫—É 422.

3. –†–∞–±–æ—Ç–∞ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏.
    # Body –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
    from fastapi import FastAPI, Body

    app = FastAPI()

    @app.post("/orders/")
    async def create_order(
        order: dict = Body(..., example={
            "user_id": 1,
            "items": [{"id": 1, "quantity": 2}]
        })
    ):
        return order

    # –í Swagger –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –ø—Ä–∏–º–µ—Ä —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞.

4. –ù–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–ª –∑–∞–ø—Ä–æ—Å–∞.
    # –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ JSON-–æ–±—ä–µ–∫—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ:
    from fastapi import FastAPI, Body

    app = FastAPI()

    @app.post("/merge/")
    async def merge_data(
        user: dict = Body(...),
        item: dict = Body(...)
    ):
        return {"user": user, "item": item}

    # –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞: {"user": {"name": "John"}, "item": {"title": "Laptop"}}

5. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API.
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π –∏ –ø—Ä–∏–º–µ—Ä–æ–≤
    from fastapi import FastAPI, Body

    app = FastAPI()

    app.post("/users/")
    async def create_user(
        user: dict = Body(
            ...,
            title="User Data",
            description="–°–æ–¥–µ—Ä–∂–∏—Ç –∏–º—è –∏ email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
            example={"name": "Alice", "email": "alice@example.com"}
        )
    ):
        return user

    # –í Swagger/Redoc –ø–æ—è–≤–∏—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Body:
- POST/PUT/PATCH-–∑–∞–ø—Ä–æ—Å—ã ‚Äî –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ —Ç–µ–ª–µ (–Ω–µ –≤ URL).
- –°–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã ‚Äî –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –º–∞—Å—Å–∏–≤—ã.
- –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π.
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ OpenAPI-—Å—Ö–µ–º—ã.

–û—Ç–ª–∏—á–∏—è Body –æ—Ç Query –∏ Path
–ü–∞—Ä–∞–º–µ—Ç—Ä	–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è	        –ü—Ä–∏–º–µ—Ä
Body	    –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON/XML)	    { "name": "Book" }
Query	    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL (?name=Book)	/items?name=Book
Path	    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏ (/items/1)	/items/1

–í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã:
–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: Body(...) ‚Äî –ø–æ–ª–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, Body(None) ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
Content-Type: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–∂–∏–¥–∞–µ—Ç—Å—è application/json.
–ê–ª–∏–∞—Å—ã: –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—Ç—å –ø–æ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –¥—Ä—É–≥–∏–º–∏ API): item_name: str = Body(..., alias="itemName")
#####


–ö–ª–∞—Å—Å HTTPException –≤ FastAPI ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ HTTP-–æ—à–∏–±–æ–∫ –∫–ª–∏–µ–Ω—Ç—É —Å —É–¥–æ–±–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º. 
–û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ—Ä–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å –Ω—É–∂–Ω—ã–º —Å—Ç–∞—Ç—É—Å-–∫–æ–¥–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, 404 Not Found –∏–ª–∏ 403 Forbidden).

–ó–∞—á–µ–º –Ω—É–∂–µ–Ω HTTPException:
- –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∞–º–∏ ‚Äî –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø—Ä–µ—Ä–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∏ –≤–µ—Ä–Ω—É—Ç—å –∫–ª–∏–µ–Ω—Ç—É –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî –≤—Å–µ –æ—à–∏–±–∫–∏ –±—É–¥—É—Ç –≤ –æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (—Å –∫–æ–¥–æ–º —Å—Ç–∞—Ç—É—Å–∞ –∏ –¥–µ—Ç–∞–ª—è–º–∏).
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAPI ‚Äî –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –≤ Swagger/Redoc.

1. –ü—Ä–æ—Å—Ç–æ–π –≤—ã–∑–æ–≤ –æ—à–∏–±–∫–∏.
    from fastapi import FastAPI, HTTPException

    app = FastAPI()

    @app.get("/items/{item_id}")
    async def read_item(item_id: int):
        if item_id == 0:
            raise HTTPException(status_code=404, detail="Item not found")
        return {"item_id": item_id}

    # –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω item_id=0, –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∏—Ç:
    # json {"detail": "Item not found"} —Å HTTP-—Å—Ç–∞—Ç—É—Å–æ–º 404.

2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.
    # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª—é–±—ã–µ JSON-–¥–∞–Ω–Ω—ã–µ –≤ –æ—Ç–≤–µ—Ç
    from fastapi import FastAPI, HTTPException

    app = FastAPI()

    @app.get("/items/{item_id}")
    async def read_item(item_id: int):
        if item_id == 0:
            raise HTTPException(
                status_code=400,
                detail="Invalid input",
                headers={"X-Error": "Missing data"},
                extra={"field": "price", "expected_type": "float"}
            )
        return {"item_id": item_id}

    # –û—Ç–≤–µ—Ç: json {"detail": "Invalid input", "field": "price", "expected_type": "float"}

3. –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
    from fastapi import FastAPI, HTTPException

    app = FastAPI()

    @app.get("/items/{item_id}")
    async def read_item(item_id: int):
        if item_id == 0:
            raise HTTPException(
                status_code=403,
                detail="Access denied",
                headers={"WWW-Authenticate": "Bearer"}
            )
        return {"item_id": item_id}

    # –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, OAuth2).

–ü—Ä–∏–º–µ—Ä—ã —á–∞—Å—Ç—ã—Ö –æ—à–∏–±–æ–∫ –∏ –∏—Ö –∫–æ–¥–æ–≤:
–ö–æ–¥	–¢–∏–ø –æ—à–∏–±–∫–∏	        –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
400	–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å	    –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞.
401	–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω	    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª —Ç–æ–∫–µ–Ω.
403	–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω	    –ù–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏—è.
404	–ù–µ –Ω–∞–π–¥–µ–Ω–æ	        –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π —Ä–µ—Å—É—Ä—Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
422	–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏	–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
500	–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞	    –î–ª—è –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤.

–ü—Ä–∏–º–µ—Ä—ã –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

async def check_admin(user_role: str):
    if user_role != "admin":
        raise HTTPException(
            status_code=403,
            detail="Only admins can perform this action"
        )

@app.delete("/users/{user_id}")
async def delete_user(user_id: int, current_user: str = Depends(get_current_user)):
    await check_admin(current_user.role)
    # ...—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

@app.get("/products/{product_id}")
async def get_product(product_id: int, db: Session = Depends(get_db)):
    product = db.get(Product, product_id)
    if not product:
        raise HTTPException(status_code=404, detail="Product not found")
    return product

3. –ö–∞—Å—Ç–æ–º–Ω–∞—è –æ—à–∏–±–∫–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

@app.post("/payment/")
async def process_payment(amount: float):
    if amount <= 0:
        raise HTTPException(
            status_code=400,
            detail="Amount must be positive",
            headers={"X-Reason": "Invalid amount"}
        )
    # ...–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞

–ö–∞–∫ HTTPException –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å FastAPI:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ JSON-–æ—Ç–≤–µ—Ç.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –æ—à–∏–±–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ª–æ–≥ —Å–µ—Ä–≤–µ—Ä–∞.
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è OpenAPI/Swagger.

–í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã
–û—Ç–ª–∏—á–∏–µ –æ—Ç status
    status —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∫–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, status.HTTP_404_NOT_FOUND).
    HTTPException ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—à–∏–±–æ–∫.

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∞ –∫–æ–≥–¥–∞ –Ω–µ—Ç?
    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –¥–ª—è –æ–∂–∏–¥–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫ (–Ω–µ—Ç –ø—Ä–∞–≤, –Ω–µ –Ω–∞–π–¥–µ–Ω–æ).
    –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–±–æ–µ–≤ —Å–µ—Ä–≤–µ—Ä–∞ (–ª—É—á—à–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 500).

–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ HTTPException —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏.

üìå –ò—Ç–æ–≥
–ö–ª–∞—Å—Å HTTPException –≤ FastAPI –Ω—É–∂–µ–Ω –¥–ª—è:
‚úÖ –ì–∏–±–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ HTTP-–æ—à–∏–±–æ–∫.
‚úÖ –í–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç—É.
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å OpenAPI (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ—à–∏–±–æ–∫).

–ë–µ–∑ –Ω–µ–≥–æ –ø—Ä–∏—à–ª–æ—Å—å –±—ã –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–≤–∞—Ç—å JSONResponse —Å –æ—à–∏–±–∫–∞–º–∏, —á—Ç–æ —É—Å–ª–æ–∂–Ω–∏–ª–æ –±—ã –∫–æ–¥.

–ü—Ä–∏–º–µ—Ä ¬´–∫–∞–∫ –Ω–µ –Ω–∞–¥–æ¬ª (–±–µ–∑ HTTPException):
python

from fastapi.responses import JSONResponse

@app.get("/items/{item_id}")
async def read_item(item_id: int):
    if item_id == 0:
        return JSONResponse(
            status_code=404,
            content={"message": "Item not found"}
        )
    return {"item_id": item_id}

–ü—Ä–∏–º–µ—Ä ¬´–∫–∞–∫ –Ω–∞–¥–æ¬ª (—Å HTTPException):
python

@app.get("/items/{item_id}")
async def read_item(item_id: int):
    if item_id == 0:
        raise HTTPException(status_code=404, detail="Item not found")
    return {"item_id": item_id}

–ö–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–∏—â–µ, –∞ –æ—à–∏–±–∫–∏ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏!
#####


–ö–ª–∞—Å—Å APIRouter –≤ FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –≥—Ä—É–ø–ø—ã —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ (endpoints) –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å. 
–≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç:
1. –†–∞–∑–¥–µ–ª—è—Ç—å –∫–æ–¥ –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, users.py, posts.py).
2. –£–ø—Ä–æ—â–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –±–æ–ª—å—à–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –¥–µ–ª–∞—è –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º.
3. –ü–æ–¥–∫–ª—é—á–∞—Ç—å —Ä–æ—É—Ç–µ—Ä—ã –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é (FastAPI) —Å –ø–æ–º–æ—â—å—é app.include_router().

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
    # main.py (–æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
    from fastapi import FastAPI
    from .routers import users, posts  # –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–æ—É—Ç–µ—Ä—ã

    app = FastAPI()

    # –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ä–æ—É—Ç–µ—Ä—ã –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
    app.include_router(users.router, prefix="/users", tags=["users"])
    app.include_router(posts.router, prefix="/posts", tags=["posts"])


    # routers/users.py (—Ä–æ—É—Ç–µ—Ä –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
    from fastapi import APIRouter

    router = APIRouter()

    @router.get("/")
    def get_users():
        return {"message": "List of users"}

    @router.post("/")
    def create_user():
        return {"message": "User created"}

    
    # routers/posts.py (—Ä–æ—É—Ç–µ—Ä –¥–ª—è –ø–æ—Å—Ç–æ–≤)
    from fastapi import APIRouter

    router = APIRouter()

    @router.get("/")
    def get_posts():
        return {"message": "List of posts"}
    
–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã APIRouter:
- prefix ‚Äì –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å –∫–æ –≤—Å–µ–º –ø—É—Ç—è–º —Ä–æ—É—Ç–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, /users).
- tags ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç endpoints –≤ Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
- responses ‚Äì –æ–±—â–∏–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è –≤—Å–µ—Ö endpoints —Ä–æ—É—Ç–µ—Ä–∞.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, APIRouter –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏ –∏–∑–±–µ–≥–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.
#####


SQLAlchemy

–ö–ª–∞—Å—Å DeclarativeBase –≤ SQLAlchemy 2.0 ‚Äî —ç—Ç–æ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π. 
–û–Ω –∑–∞–º–µ–Ω—è–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –ø–æ–¥—Ö–æ–¥ —Å declarative_base() –∏–∑ SQLAlchemy 1.x –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–∏–π –∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è ORM-–º–æ–¥–µ–ª–µ–π.
–î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω DeclarativeBase:
1. –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
    –í—Å–µ ORM-–∫–ª–∞—Å—Å—ã (—Ç–∞–±–ª–∏—Ü—ã –ë–î) –¥–æ–ª–∂–Ω—ã –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç DeclarativeBase. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç SQLAlchemy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≤ —Å–∏—Å—Ç–µ–º–µ.
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
    –ß–µ—Ä–µ–∑ DeclarativeBase –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å:
        - –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ö–µ–º—É –ë–î).
        - –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
        - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å mypy –∏ IDE.

3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π (Mapped)
    –í SQLAlchemy 2.0 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Å Mapped[] –∏ mapped_column(), –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç DeclarativeBase.

üîπ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
üìå 1. –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä (SQLAlchemy 2.0+)

    from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column

    # 1. –°–æ–∑–¥–∞–µ–º –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
    class Base(DeclarativeBase):
        pass

    # 2. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–æ–¥–µ–ª—å (–Ω–∞—Å–ª–µ–¥—É–µ–º—Å—è –æ—Ç Base)
    class User(Base):
        __tablename__ = "users"

        id: Mapped[int] = mapped_column(primary_key=True)
        name: Mapped[str] = mapped_column(String(50))

üìå 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ö–µ–º—ã –ë–î)

    from sqlalchemy.orm import DeclarativeBase

    class Base(DeclarativeBase):
        # –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
        __abstract__ = True
        metadata.schema = "my_schema"  # –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –±—É–¥—É—Ç –≤ —Å—Ö–µ–º–µ `my_schema`

üîπ –û—Ç–ª–∏—á–∏—è –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ (declarative_base())
SQLAlchemy 1.x (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å—Ç–∏–ª—å)

    from sqlalchemy.ext.declarative import declarative_base

    Base = declarative_base()  # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å

    class User(Base):
        __tablename__ = "users"
        id = Column(Integer, primary_key=True)

SQLAlchemy 2.0 (–Ω–æ–≤—ã–π —Å—Ç–∏–ª—å)

    from sqlalchemy.orm import DeclarativeBase

    class Base(DeclarativeBase):  # –Ø–≤–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞
        pass

    class User(Base):
        __tablename__ = "users"
        id: Mapped[int] = mapped_column(primary_key=True)

    –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ (DeclarativeBase):
        - –õ—É—á—à–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å Mapped).
        - –ë–æ–ª–µ–µ —è–≤–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (–Ω–µ –Ω—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å declarative_base()).
        - –ì–∏–±–∫–æ—Å—Ç—å (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –æ–±—â–∏–µ –º–µ—Ç–æ–¥—ã/–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Base).

üîπ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
1. –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

    from sqlalchemy.orm import DeclarativeBase
    from sqlalchemy import String

    class Base(DeclarativeBase):
        # –î–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –ø–æ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è String(255)
        type_annotation_map = {
            str: String(255)
        }

2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º API

    from sqlalchemy.ext.asyncio import AsyncAttrs

    class Base(AsyncAttrs, DeclarativeBase):
        pass

    # –¢–µ–ø–µ—Ä—å –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
    user = await session.get(User, 1)
    posts = await user.awaitable_attrs.posts  # –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–µ–π

üîπ –í—ã–≤–æ–¥
    DeclarativeBase ‚Äî —ç—Ç–æ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è ORM-–º–æ–¥–µ–ª–µ–π –≤ SQLAlchemy 2.0.
    –ó–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ä—ã–π declarative_base().
    –î–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –º–æ–¥–µ–ª–µ–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ç–∏–ø–æ–≤.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å Mapped –∏ mapped_column.
–í—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –Ω–∞ SQLAlchemy 2.0 –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥.
#####


–ö–ª–∞—Å—Å Mapped –≤ SQLAlchemy ORM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–∏–ª—è. 
–û–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∞—Ç—Ä–∏–±—É—Ç –∫–ª–∞—Å—Å–∞ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –Ω–∞ —Å—Ç–æ–ª–±–µ—Ü –∏–ª–∏ —Å–≤—è–∑—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
üîπ –î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω Mapped?

    –¢–∏–ø–∏–∑–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –º–æ–¥–µ–ª–∏
        –ü–æ–∑–≤–æ–ª—è–µ—Ç —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö Python (int, str, datetime –∏ —Ç. –¥.), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–æ–ª–±—Ü—É –≤ –ë–î.
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å mapped_column (–≤ SQLAlchemy 2.0+) –∏–ª–∏ Column (–≤ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö).

    –ü–æ–¥–¥–µ—Ä–∂–∫–∞ IDE –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤
        –ü–æ–º–æ–≥–∞–µ—Ç PyCharm, VSCode, mypy –∏ –¥—Ä—É–≥–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º –ø–æ–Ω–∏–º–∞—Ç—å —Ç–∏–ø—ã –ø–æ–ª–µ–π –º–æ–¥–µ–ª–∏.

    –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π (relationships)
        –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–æ–ª–µ —è–≤–ª—è–µ—Ç—Å—è —Å–≤—è–∑—å—é (relationship) —Å –¥—Ä—É–≥–æ–π –º–æ–¥–µ–ª—å—é.

üîπ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
üìå 1. –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å (SQLAlchemy 2.0+)

    from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column

    class Base(DeclarativeBase):
        pass

    class User(Base):
        __tablename__ = "users"

        id: Mapped[int] = mapped_column(primary_key=True)
        name: Mapped[str] = mapped_column(String(50))
        age: Mapped[int | None]  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ (NULL –≤ –ë–î)

        Mapped[int] –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–æ–ª–µ id –∏–º–µ–µ—Ç —Ç–∏–ø int –≤ Python –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç INTEGER (–∏–ª–∏ SERIAL) –≤ –ë–î.

        Mapped[str] ‚Üí VARCHAR / TEXT.

        Mapped[int | None] ‚Üí –ø–æ–ª–µ –º–æ–∂–µ—Ç –±—ã—Ç—å NULL –≤ –ë–î (Optional[int] –≤ Python).

üìå 2. –°–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏ (relationships)

    from sqlalchemy.orm import relationship

    class Post(Base):
        __tablename__ = "posts"

        id: Mapped[int] = mapped_column(primary_key=True)
        title: Mapped[str]
        author_id: Mapped[int] = mapped_column(ForeignKey("users.id"))
        
        # –°–≤—è–∑—å —Å User (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)
        author: Mapped["User"] = relationship(back_populates="posts")

    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –≤ User
    class User(Base):
        # ... (–ø–æ–ª—è –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞)
        posts: Mapped[list["Post"]] = relationship(back_populates="author")

    * Mapped["User"] —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ author ‚Äî —ç—Ç–æ —Å–≤—è–∑—å —Å –º–æ–¥–µ–ª—å—é User.

    * Mapped[list["Post"]] –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ posts ‚Äî —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ Post.

üîπ –û—Ç–ª–∏—á–∏—è –æ—Ç SQLAlchemy 1.x (—Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å)
–†–∞–Ω—å—à–µ (–¥–æ SQLAlchemy 2.0) —Ç–∏–ø—ã —É–∫–∞–∑—ã–≤–∞–ª–∏—Å—å –±–µ–∑ Mapped:

    # SQLAlchemy 1.x
    class User(Base):
        __tablename__ = "users"
        id = Column(Integer, primary_key=True)  # –ë–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
        name = Column(String(50))

–¢–µ–ø–µ—Ä—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∏–ª—å (Mapped + mapped_column), —Ç–∞–∫ –∫–∞–∫ –æ–Ω:
    - –ë–æ–ª–µ–µ —è–≤–Ω—ã–π.
    - –õ—É—á—à–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è IDE.
    - –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mypy –∏ –¥—Ä—É–≥–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã.

üîπ –í—ã–≤–æ–¥
    Mapped –Ω—É–∂–µ–Ω –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–µ–π –º–æ–¥–µ–ª–∏ –≤ SQLAlchemy 2.0+.
    –£–ª—É—á—à–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É IDE.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, —Ç–∞–∫ –∏ –¥–ª—è —Å–≤—è–∑–µ–π (relationship).
–ï—Å–ª–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å SQLAlchemy 2.0+, –ª—É—á—à–µ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mapped –¥–ª—è —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–æ–≤.
#####


–ö–ª–∞—Å—Å mapped_column() –≤ SQLAlchemy ORM (–≤–µ—Ä—Å–∏–∏ 2.0 –∏ –≤—ã—à–µ) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —è–≤–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã –≤ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö. 
–û–Ω –∑–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Column() –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ë–î.
üîπ –î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω mapped_column?
    –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã
        –£–∫–∞–∑—ã–≤–∞–µ—Ç –∏–º—è, —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (primary_key, unique, nullable –∏ —Ç. –¥.):
        id: Mapped[int] = mapped_column(primary_key=True)  # –ê–Ω–∞–ª–æ–≥ `id = Column(Integer, primary_key=True)`

    –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —Ç–∏–ø–æ–≤ Python (Mapped) 
        –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–≤—è–∑–∫–µ —Å Mapped[], –ø–æ–∑–≤–æ–ª—è—è IDE –∏ mypy –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:
        name: Mapped[str] = mapped_column(String(50))  # –ü–æ–ª–µ `name` —Ç–∏–ø–∞ `str` (VARCHAR(50) –≤ –ë–î)

    –£–ø—Ä–æ—â–µ–Ω–∏–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ (–ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Column)
        –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ Mapped, –∞ –Ω–µ –≤ mapped_column:
        age: Mapped[int] = mapped_column()  # INT –≤ –ë–î
        # –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ:
        age = Column(Integer)

    –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π SQLAlchemy 2.0
        –õ—É—á—à–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º API –∏ —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π.

üîπ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
üìå 1. –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å

    from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column
    from sqlalchemy import String

    class Base(DeclarativeBase):
        pass

    class User(Base):
        __tablename__ = "users"

        # –° —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–∏–ø–∞ –≤ –ë–î
        id: Mapped[int] = mapped_column(primary_key=True)
        name: Mapped[str] = mapped_column(String(50))
        age: Mapped[int | None] = mapped_column()  # NULLABLE (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ)

    # id ‚Üí INT PRIMARY KEY (–∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç, –µ—Å–ª–∏ –ë–î –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç).
    # name ‚Üí VARCHAR(50).
    # age ‚Üí INT (–º–æ–∂–µ—Ç –±—ã—Ç—å NULL).

üìå 2. –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤

    from sqlalchemy import ForeignKey

    class Post(Base):
        __tablename__ = "posts"

        id: Mapped[int] = mapped_column(primary_key=True)
        title: Mapped[str] = mapped_column(String(100), nullable=False)
        user_id: Mapped[int] = mapped_column(ForeignKey("users.id"))  # –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á

    # title ‚Üí VARCHAR(100) NOT NULL.
    # user_id ‚Üí INT + FOREIGN KEY.

üìå 3. –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

    from datetime import datetime

    class LogEntry(Base):
        __tablename__ = "logs"

        id: Mapped[int] = mapped_column(primary_key=True)
        created_at: Mapped[datetime] = mapped_column(default=datetime.now)  # –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ
        is_active: Mapped[bool] = mapped_column(default=True)  # DEFAULT TRUE

üîπ –û—Ç–ª–∏—á–∏—è –æ—Ç Column (SQLAlchemy 1.x)
–ü–∞—Ä–∞–º–µ—Ç—Ä	    mapped_column (SQLAlchemy 2.0+)	                        Column (SQLAlchemy 1.x)
–°–∏–Ω—Ç–∞–∫—Å–∏—Å       name: Mapped[—Ç–∏–ø] = mapped_column(...)	                name = Column(—Ç–∏–ø, ...)
–¢–∏–ø–∏–∑–∞—Ü–∏—è       –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Mapped[] + mypy	                    –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏
–ó–Ω–∞—á–µ–Ω–∏—è    	default=func() (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ)                 default=func() + server_default –¥–ª—è SQL
–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
–í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏	mapped_column(ForeignKey(...))	                        Column(Integer, ForeignKey(...))

üîπ –í—ã–≤–æ–¥

    mapped_column ‚Äî —ç—Ç–æ –∑–∞–º–µ–Ω–∞ Column –≤ SQLAlchemy 2.0.
    –ü–æ–∑–≤–æ–ª—è–µ—Ç —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∏–ø—ã —á–µ—Ä–µ–∑ Mapped[].
    –£–ø—Ä–æ—â–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ –µ–≥–æ (–∞ –Ω–µ —Å—Ç–∞—Ä—ã–π Column) –≤ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.
#####


–ú–æ–¥—É–ª—å sqlalchemy.exc —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è (errors), –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å SQLAlchemy. 
–≠—Ç–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, 
—Ç–∞–∫–∏–µ –∫–∞–∫ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º, –Ω–∞—Ä—É—à–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –∏ —Ç. –¥.

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ SQLAlchemy:
    - –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ä–≤–µ—Ä —É–ø–∞–ª).
    - –ù–∞—Ä—É—à–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ (–¥—É–±–ª–∏–∫–∞—Ç PRIMARY KEY –∏–ª–∏ UNIQUE).
    - –û—à–∏–±–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–æ—Ç–∫–∞—Ç, –¥–µ–¥–ª–æ–∫–∏).
    - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Å–∏–Ω—Ç–∞–∫—Å–∏—Å SQL, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∞–±–ª–∏—Ü—ã).

–û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ sqlalchemy.exc:
–ò—Å–∫–ª—é—á–µ–Ω–∏–µ	                    –ö–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç?
IntegrityError                  –ù–∞—Ä—É—à–µ–Ω–∏–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, NOT NULL, FOREIGN KEY, UNIQUE).
OperationalError                –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î (—Å–µ—Ä–≤–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞).
ProgrammingError                –û—à–∏–±–∫–∞ –≤ SQL-–∑–∞–ø—Ä–æ—Å–µ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∞–±–ª–∏—Ü—ã/–∫–æ–ª–æ–Ω–∫–∏).
NoResultFound	                –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ .one() –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏.
MultipleResultsFound	        –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ .one() –Ω–∞–π–¥–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π (—Ö–æ—Ç—è –æ–∂–∏–¥–∞–ª–∞—Å—å –æ–¥–Ω–∞).
DBAPIError (–±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å)	    –û–±—â–∞—è –æ—à–∏–±–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞ –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, psycopg2, sqlite3).

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–∞ (IntegrityError)

    from sqlalchemy import create_engine
    from sqlalchemy.orm import sessionmaker
    from sqlalchemy.exc import IntegrityError

    engine = create_engine("sqlite:///mydb.db")
    Session = sessionmaker(bind=engine)
    session = Session()

    try:
        # –ü—ã—Ç–∞–µ–º—Å—è –¥–æ–±–∞–≤–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç PRIMARY KEY
        session.execute("INSERT INTO users (id, name) VALUES (1, 'Alice')")
        session.commit()
    except IntegrityError as e:
        session.rollback()
        print(f"–û—à–∏–±–∫–∞: –∑–∞–ø–∏—Å—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç! {e}")

2. –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (OperationalError)

    from sqlalchemy.exc import OperationalError

    try:
        engine = create_engine("postgresql://user:wrong-password@localhost/mydb")
        engine.connect()
    except OperationalError as e:
        print(f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î: {e}")

3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (NoResultFound)

    from sqlalchemy.exc import NoResultFound
    from sqlalchemy import select

    stmt = select(User).where(User.id == 999)  # –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID

    try:
        user = session.execute(stmt).scalar_one()
    except NoResultFound:
        print("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!")

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?
    - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (FastAPI, Flask): –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ë–î –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç—É 500 –∏–ª–∏ 400 –∫–æ–¥–æ–≤.
    - –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏: —á—Ç–æ–±—ã –ø–æ–≤—Ç–æ—Ä—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ—è—Ö.
    - –¢–µ—Å—Ç—ã: –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∂–∏–¥–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ –¥—É–±–ª–∏–∫–∞—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è).

–ò—Ç–æ–≥
–ú–æ–¥—É–ª—å sqlalchemy.exc ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è –æ—Ç–ª–æ–≤–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ SQLAlchemy. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ, —á—Ç–æ–±—ã:
    - –ù–µ –ø–∞–¥–∞—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ë–î.
    - –î–∞–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Email —É–∂–µ –∑–∞–Ω—è—Ç").
    - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–±–æ–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

–ï—Å–ª–∏ –≤–º–µ—Å—Ç–æ –æ—à–∏–±–æ–∫ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ "—Å—ã—Ä—ã–µ" tracebacks ‚Äî –∑–Ω–∞—á–∏—Ç, –æ–±—Ä–∞–±–æ—Ç–∫–∏ exc –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç!
#####


–ö–ª–∞—Å—Å select –≤ SQLAlchemy –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–∏–ø–∞ SELECT –≤ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–º —Å—Ç–∏–ª–µ. 
–û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é Python-–∫–æ–¥–∞, –∞ –Ω–µ —Ä—É—á–Ω–æ–≥–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è SQL.

–î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω select()?
1. –ó–∞–º–µ–Ω–∞ —á–∏—Å—Ç–æ–≥–æ SQL
    –í–º–µ—Å—Ç–æ: SELECT id, name FROM users WHERE email LIKE '%@gmail.com';
    –ú–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å —Ç–∞–∫:

    from sqlalchemy import select
    stmt = select(User.id, User.name).where(User.email.like("%@gmail.com"))

2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ placeholders (?, %s), –∞ –Ω–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–π –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏.

3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    JOIN-—ã (select(...).join(...)),
    –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (group_by),
    –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (order_by),
    –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (func.count()).

4. –õ–µ–Ω–∏–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —è–≤–Ω–æ–º –≤—ã–∑–æ–≤–µ .execute() –∏–ª–∏ –≤ —Å–µ—Å—Å–∏–∏.

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
1. –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å (–∞–Ω–∞–ª–æ–≥ SELECT * FROM users)

    from sqlalchemy import select
    from models import User

    stmt = select(User)  # –í—ã–±—Ä–∞—Ç—å –≤—Å–µ –ø–æ–ª—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã User
    result = session.execute(stmt)
    users = result.scalars().all()  # –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ User

2. –í—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª–µ–π

    stmt = select(User.id, User.name)  # –¢–æ–ª—å–∫–æ id –∏ name
    result = session.execute(stmt)
    for row in result:
        print(row.id, row.name)  # –î–æ—Å—Ç—É–ø –∫ –ø–æ–ª—è–º —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É

3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (WHERE)

    stmt = select(User).where(User.age > 18)  # WHERE age > 18

4. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (ORDER BY)

    stmt = select(User).order_by(User.name.desc())  # ORDER BY name DESC

5. JOIN —Å –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü–µ–π

    from models import User, Order

    stmt = select(User, Order).join(Order, User.id == Order.user_id)

6. –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

    from sqlalchemy import func

    stmt = select(func.count(User.id))  # SELECT COUNT(id) FROM users
    total_users = session.execute(stmt).scalar()  # –ü–æ–ª—É—á–∏—Ç—å —á–∏—Å–ª–æ

üîπ –ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

    –° —Å–µ—Å—Å–∏–µ–π SQLAlchemy (–æ–±—ã—á–Ω—ã–π ORM):
        result = session.execute(stmt)
        users = result.scalars().all()  # –í—Å–µ –∑–∞–ø–∏—Å–∏
        user = result.scalar_one()      # –†–æ–≤–Ω–æ –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å (–∏–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ)

    –ë–µ–∑ —Å–µ—Å—Å–∏–∏ (—Ç–æ–ª—å–∫–æ Core):
        with engine.connect() as conn:
            result = conn.execute(stmt)
            rows = result.fetchall()  # –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π


–ò—Ç–æ–≥

select() ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π (SQLAlchemy 2.0+) —Å–ø–æ—Å–æ–± —Å—Ç—Ä–æ–∏—Ç—å SELECT-–∑–∞–ø—Ä–æ—Å—ã –≤ Python-–∫–æ–¥–µ. 
‚úÖ –ë–µ–∑–æ–ø–∞—Å–µ–Ω (–Ω–µ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π),
‚úÖ –ì–∏–±–æ–∫ (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç JOIN, –∞–≥—Ä–µ–≥–∞—Ü–∏–∏),
‚úÖ –£–¥–æ–±–µ–Ω –¥–ª—è IDE (–ø–æ–¥—Å–∫–∞–∑–∫–∏ —Ç–∏–ø–æ–≤).
#####


Pydantic

–ö–ª–∞—Å—Å BaseModel –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Pydantic ‚Äî —ç—Ç–æ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π, –ø–∞—Ä—Å–∏–Ω–≥–æ–º –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π. 
–û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∏–∑ API, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, —Ñ–æ—Ä–º –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

–î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω BaseModel?
1. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã –ø–æ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, str, int, bool).
    - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–æ–∫—É "123" ‚Üí —á–∏—Å–ª–æ 123).
    - –í—ã–¥–∞—ë—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ö–µ–º–µ.
2. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
    - –ú–æ–∂–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ JSON (.model_dump(), .model_dump_json()).
    - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON (model_validate()).
3. –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –∏ IDE-–ø–æ–¥–¥–µ—Ä–∂–∫–∞
    - –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python-–∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ (str, int, Optional, List –∏ —Ç. –¥.).
    - –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ PyCharm/VSCode –±–ª–∞–≥–æ–¥–∞—Ä—è @dataclass-–ø–æ–¥–æ–±–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é.
4. –†–∞–±–æ—Ç–∞ —Å API (FastAPI, Django Ninja –∏ –¥—Ä.)
    –í FastAPI –º–æ–¥–µ–ª–∏ Pydantic –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è:
        - –í–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ (request.body).
        - –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ API (response_model).
        - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ö–µ–º—ã API (Swagger/OpenAPI).

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
1. –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å

    from pydantic import BaseModel

    class User(BaseModel):
        id: int
        name: str
        email: str | None = None  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ

    # –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
    user = User(id=1, name="Alice")  # email –Ω–µ —É–∫–∞–∑–∞–Ω, –Ω–æ —ç—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ (None)
    print(user.model_dump())  # {'id': 1, 'name': 'Alice', 'email': None}

2. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–æ—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–º —Ç–∏–ø–µ)

    from pydantic import BaseModel

    class User(BaseModel):
        id: int
        name: str
        email: str | None = None  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ

    try:
        user = User(id="not_an_int", name="Bob")  # –û—à–∏–±–∫–∞: id –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å int
    except ValueError as e:
        print(e)  # 1 validation error for User: id -> Input should be a valid integer

3. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ JSON

    from pydantic import BaseModel

    class User(BaseModel):
        id: int
        name: str
        email: str | None = None  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ

    user = User(id=1, name="Alice", email=None)
    json_data = user.model_dump_json()
    print(json_data)  # '{"id":1,"name":"Alice","email":null}'


–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å SQLAlchemy DeclarativeBase
Pydantic(BaseModel)                     SQLAlchemy(DeclarativeBase)
–î–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (API, –∫–æ–Ω—Ñ–∏–≥–∏)     –î–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –ë–î
–†–∞–±–æ—Ç–∞–µ—Ç —Å JSON, dict	                –†–∞–±–æ—Ç–∞–µ—Ç —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ –ë–î
–ù–µ—Ç –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –ë–î	                    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ORM (SQLAlchemy)

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –ë–î ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQLAlchemy DeclarativeBase.
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ API ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pydantic BaseModel.
#####


–ö–ª–∞—Å—Å EmailStr –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Pydantic ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–∏–ø —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, 
—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç—É email (–Ω–∞–ø—Ä–∏–º–µ—Ä, user@example.com). 
–ï—Å–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç, Pydantic –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É.

–î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω EmailStr:
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è email
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å—Ç—Ä–æ–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É email (–Ω–∞–ª–∏—á–∏–µ @, –¥–æ–º–µ–Ω–∞ –∏ —Ç. –¥.).
    –ü—Ä–∏–º–µ—Ä –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö email, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑–æ–≤—É—Ç –æ—à–∏–±–∫—É:
        "user" (–Ω–µ—Ç @ –∏ –¥–æ–º–µ–Ω–∞)
        "user@example" (–Ω–µ—Ç –¥–æ–º–µ–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è, –Ω–∞–ø—Ä–∏–º–µ—Ä .com)
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –º–æ–¥–µ–ª—è—Ö Pydantic (BaseModel)
    –£–¥–æ–±–Ω–æ –¥–ª—è –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å email (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É –∏ —Ç. –¥.).
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI
    –ï—Å–ª–∏ –º–æ–¥–µ–ª—å —Å EmailStr –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ FastAPI, Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ—Ç–∏—Ç –ø–æ–ª–µ –∫–∞–∫ format: email.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
1. –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

    from pydantic import BaseModel, EmailStr

    class User(BaseModel):
        name: str
        email: EmailStr  # –¢–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–µ email!

    # –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email
    user1 = User(name="Alice", email="alice@example.com")  # –†–∞–±–æ—Ç–∞–µ—Ç

    # –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email
    try:
        user2 = User(name="Bob", email="bob")  # –í—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É
    except ValueError as e:
        print(e)
        # 1 validation error for User
        # email -> value is not a valid email address

2. FastAPI (–ø—Ä–∏–º–µ—Ä —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞)

    from fastapi import FastAPI
    from pydantic import BaseModel, EmailStr

    app = FastAPI()

    class UserCreate(BaseModel):
        email: EmailStr
        password: str

    @app.post("/register")
    def register(user: UserCreate):
        return {"message": f"User {user.email} registered!"}

    # –í Swagger UI –ø–æ–ª–µ email –±—É–¥–µ—Ç –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ format: email.
    # FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É 422, –µ—Å–ª–∏ email –Ω–µ–≤–∞–ª–∏–¥–µ–Ω.

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è?

Pydantic –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç RFC 5322 (—Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ —É–ø—Ä–æ—â–µ–Ω–∏—è–º–∏).
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
    –ù–∞–ª–∏—á–∏–µ —Å–∏–º–≤–æ–ª–∞ @ –∏ –¥–æ–º–µ–Ω–Ω–æ–π —á–∞—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, example.com).
    –î–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ (–¥–æ @).
    –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –¥–æ–º–µ–Ω –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ.

–ò—Ç–æ–≥
EmailStr ‚Äî —ç—Ç–æ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –≤ –ø–æ–ª–µ –º–æ–¥–µ–ª–∏ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email. 
–û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö (FastAPI, Django Ninja) –∏ –ª—é–±—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, –≥–¥–µ –≤–∞–ª–∏–¥–∞—Ü–∏—è email –∫—Ä–∏—Ç–∏—á–Ω–∞.
